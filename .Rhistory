mozzie.Rproj
devtools::load_all(".")
warnings()
install.packages("roxygen2")
library(roxygen2)
devtools::document()
install.packages("ggvis")
library(ggvis)
devtools::document()
rbern(1,0.45)
library(distribution)
install.packages("distribution")
devtools::document()
devtools::use_testthat()
devtools::use_testthat()
usethis::use_testthat()
devtools::load_all(".")
initialise_adults(10,0.45)
devtools::load_all(".")
initialise_adults(10,0.45)
init_juv_stage(10)
devtools::document()
library(mozzie)
packages()
update.packages()
install.packages("ggplot2")
old.packages()
devtools::load_all(".")
library(mozzie)
devtools::document()
devtools::document()
library(mozzie)
devtools::load_all(".")
devtools::document()
help("assign_grid")
document()
devtools::document()
devtools::document()
devtools::document()
library(mozzie)
install.packages("rgeos")
install.packages("rgeos")
library(rgeos)
library(mozzie)
library(dplyr)
library(rbenchmark)
library(progress) #progress bar for for loop
library(magrittr)
library(data.table)
library(sp) #for the boundary check when dealing with mozzie dispersal
library(truncnorm) #for parameter sampling from the truncated normal (needed for ABC step)
library(flexsurv) #used for the Gompertz distribution for age distribution
library(geosphere) #used for distance and dispersal calculations
library(MCMCpack) #used for dirichlet distribution samples
library(lattice) #used for dividing simulation area into grid for temperature deviates
library(mozzie) #for all the functions!
# Read in data files ----
boundaryDat <- read.table("inst/exdata/New_pp_Bound.txt", header=TRUE) #Boundary data for the boundary of the area used in trial (given as a set of lat/long points)
minTemp     <- read.table("inst/exdata/cairnsAero_minTemp.txt", header=TRUE) #Weather data over 90 days as provided by BOM
maxTemp     <- read.table("inst/exdata/cairnsAero_maxTemp.txt", header=TRUE) #Weather data over 90 days as provided by BOM
const       <- read.table("inst/exdata/constants.txt", header=TRUE) #constants used for EKM calculations
releaseDat  <- read.table("inst/exdata/PP_release.txt", header=TRUE) #Data regarding mosquito releases
max_age         <- 30 #mozzies who reach this age automatically die naturally
max_juv_age     <- 14 #juveniles who reach this age automatically become adults
max_pop_size    <- 100000 #if adult population exceeds this size, terminate simulation
init_prop_inf   <- 0 #initial proportion of wild mozzies carrying Wolbachia- we expect this to be 0
max_daily_mates <- 2 #maximum number of mating events a MALE mosquito can have in a day (from literature)
include_microclimates <- 1 #Set to 1 to include microclimates effect, 0 to not include
gridSize        <- 0.00025 # Size of grid spacing for microclimates
noLandTypes     <- 7 # Number of land types considered in microclimate analysis
typeTempDevs    <- c(1,-2,-1,10,5,-3, 2) # Temperature deviates for each land type- FIX (should be read in)
# Parameter generation for RABC ----
param <- data.frame(lambda = rgamma(1,3,22),
pmale = 0.45, #proportion of male mosquitoes in wild population: FIXED
k = rgamma(1,shape=1,scale=1/35),
phi = runif(1,0,0.1), #hyperparameter for probability that mozzies are trapped by any given trap
a = rtruncnorm(1,mean=0.02,sd=0.01,a=0,b=0.5), #Scale parameter regarding probability of natural death (Gompertz model)
b = rtruncnorm(1,mean=0.22,sd=0.05,a=0,b=0.5), #Scale parameter regarding probability of natural death (Gompertz model)
alpha_a = 0.1, #adult mortality rate, approx. from literature
alpha_j = 0.2, #juvenile mortality rate: this is made up
p_1 = 1, #Probability of complete maternal transmission (virtually 100% according to Ross '16 & '17)
eta_1 = round(rnorm(1,mean=40,sd=7),0), #no. of offspring produced by Wb non-carrier mothers
eta_2 = eta_1) #this was changed 8/1/20: Dutra15 and Ant18 imply eta_1 = eta_2
# Parameter generation for RABC ----
param <- data.frame(lambda = rgamma(1,3,22),
pmale = 0.45, #proportion of male mosquitoes in wild population: FIXED
k = rgamma(1,shape=1,scale=1/35),
phi = runif(1,0,0.1), #hyperparameter for probability that mozzies are trapped by any given trap
a = rtruncnorm(1,mean=0.02,sd=0.01,a=0,b=0.5), #Scale parameter regarding probability of natural death (Gompertz model)
b = rtruncnorm(1,mean=0.22,sd=0.05,a=0,b=0.5), #Scale parameter regarding probability of natural death (Gompertz model)
alpha_a = 0.1, #adult mortality rate, approx. from literature
alpha_j = 0.2, #juvenile mortality rate: this is made up
p_1 = 1, #Probability of complete maternal transmission (virtually 100% according to Ross '16 & '17)
eta_1 = round(rnorm(1,mean=40,sd=7),0), #no. of offspring produced by Wb non-carrier mothers
eta_2 = 0) #this was changed 8/1/20: Dutra15 and Ant18 imply eta_1 = eta_2
#eta_2 = round(rnorm(1,mean=30,sd=5),0)) #no. of offspring produced by Wb carrier mothers
param$eta_2 <- param$eta_1
# Variable initialisation ----
N       <- 190 #number of adult mosquitoes at time t=0. To be initialised between 4000 to 20000
Njuv    <- 2 #number of juvenile CLUSTERS (not individuals) at time t=0
idStart <- N+1 #ID numbers of initial adults will be 1:N, then we start at N+1 for any new adult mosquito within simulation
noTimeSteps <- 90 #our simulation runs for 90 days
t <- 0 #timestep; starts from 0.
# Calculate temperature and growth charts ----
#Chart of average daily temperatures for each day of the simulation
dailyTemps <- temperature_chart(minTemp, maxTemp, noTimeSteps)
# If we're running microclimates, set them up ----
if(include_microclimates == 1){
EKMChart <- initialise_enzyme_wmicroclim(boundaryDat, dailyTemps, typeTempDevs, noTimeSteps, noLandTypes, gridSize, const)
} else if(include_microclimates == 0){
EKMChart <- initialize_enzyme(dailyTemps) #chart of daily updates for EKS
}
# If we're running microclimates, set them up ----
if(include_microclimates == 1){
print("Including microclimates")
EKMChart <- initialise_enzyme_wmicroclim(boundaryDat, dailyTemps, typeTempDevs, noTimeSteps, noLandTypes, gridSize, const)
} else if(include_microclimates == 0){
print("No microclimates")
EKMChart <- initialize_enzyme(dailyTemps) #chart of daily updates for EKS
}
EKMChart <- initialise_enzyme_wmicroclim(boundaryDat, dailyTemps, typeTempDevs, noTimeSteps, noLandTypes, gridSize, const)
EKMChart <- initialise_enzyme_wmicroclim(boundary.bb, dailyTemps, typeTempDevs, noTimeSteps, noLandTypes, gridSize, const)
boundary.bb <- read.table("inst/exdata/testboundary.txt", header=TRUE) # Bounding box of boundary, used for microclimates
View(boundary.bb)
EKMChart <- initialise_enzyme_wmicroclim(boundary.bb, dailyTemps, typeTempDevs, noTimeSteps, noLandTypes, gridSize, const)
EKMChart <- initialise_enzyme_wmicroclim(boundary.bb, dailyTemps, typeTempDevs, noTimeSteps, noLandTypes, gridSize, const)
library(mozzie)
EKMChart <- initialise_enzyme_wmicroclim(boundary.bb, dailyTemps, typeTempDevs, noTimeSteps, noLandTypes, gridSize, const)
View(EKMChart)
EKMChart[[1]]
EKMChart[[2]][5, ][3]
EKMChart[[2]]
R.version.string
